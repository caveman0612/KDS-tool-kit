/sys.scripts.do?content=function%20revertToUpdate%28tableName%2c%20sysId%2c%20updateNumber%29%20%7B%0A%0A%20%20%20%20var%20current%20%3D%20buildHistoricalRecord%28tableName%2c%20sysId%2c%20updateNumber%29%0A%20%20%20%20var%20previous%20%3D%20buildHistoricalRecord%28tableName%2c%20sysId%2c%20updateNumber%20-%201%29%0A%20%20%20%20%0A%20%20%20%20var%20brsTriggered%20%3D%20%5b%5d%3B%0A%20%20%20%20var%20brGR%20%3D%20new%20GlideRecord%28%27sys_script%27%29%3B%0A%20%20%20%20brGR.addQuery%28%27collection%27%2c%20GlideDBObjectManager.get%28%29.getTables%28tableName%29%29%3B%20%2f%2f%20look%20for%20parent%20tables%20too%0A%20%20%20%20brGR.addQuery%28%27active%27%2c%20true%29%3B%0A%20%20%20%20brGR.query%28%29%3B%0A%0A%20%20%20%20while%20%28brGR.next%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20var%20conditionBool%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20var%20filter_bool%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20var%20condition%20%3D%20brGR.getValue%28%27condition%27%29%3B%0A%20%20%20%20%20%20%20%20var%20filter_condition%20%3D%20brGR.getValue%28%27filter_condition%27%29%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28condition%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20vars%20%3D%20%7B%22current%22%3a%20current%2c%20%22previous%22%3a%20previous%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20evaluator%20%3D%20new%20GlideScopedEvaluator%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20conditionBool%20%3D%20evaluator.evaluateScript%28brGR%2c%20%27condition%27%2c%20vars%29%3B%0A%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20conditionBool%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20%28filter_condition%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_bool%20%3D%20GlideFilter.checkRecord%28current%2c%20filter_condition%2c%20true%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_bool%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28conditionBool%20%26%26%20filter_bool%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20brsTriggered.push%28brGR.name.toString%28%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20gs.print%28brsTriggered.join%28%22\n%22%29%29%3B%0A%0A%7D%0A%0Afunction%20buildHistoricalRecord%28tableName%2c%20sysId%2c%20updateNumber%29%20%7B%0A%20%20%20%20var%20histGR%20%3D%20new%20GlideRecord%28%27sys_history_line%27%29%3B%0A%20%20%20%20histGR.addQuery%28%27set.id%27%2c%20sysId%29%3B%0A%20%20%20%20histGR.addQuery%28%27set.table%27%2c%20tableName%29%3B%0A%20%20%20%20histGR.addQuery%28%27update%27%2c%20%22>%3D%22%2c%20updateNumber%29%3B%0A%20%20%20%20histGR.addQuery%28%27type%27%2c%20%22audit%22%29%3B%0A%20%20%20%20histGR.orderByDesc%28%27sys_created_on%27%29%3B%0A%20%20%20%20histGR.query%28%29%3B%0A%0A%20%20%20%20var%20recordGR%20%3D%20new%20GlideRecord%28tableName%29%3B%0A%20%20%20%20recordGR.get%28sysId%29%0A%0A%20%20%20%20while%20%28histGR.next%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20recordGR.setValue%28histGR.getValue%28%22field%22%29%2c%20histGR.getValue%28%22old_value%22%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20recordGR%0A%7D%0A%0ArevertToUpdate%28$TABLE%2c%20$sys_id%2c%20$0%29%3B